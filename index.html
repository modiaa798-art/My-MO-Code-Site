<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MoCode | Cyber Defense</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ff9d;
            --secondary: #ff0055;
            --training: #00d2ff;
            --bg-dark: #080810;
            --panel-bg: rgba(15, 20, 35, 0.95);
            --text-main: #e0e6ed;
            --font-main: 'Tajawal', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-dark);
            color: var(--text-main);
            min-height: 100vh;
            /* ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ */
            overflow-y: auto;
            overflow-x: hidden;
            background-image: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #000 100%);
            background-attachment: fixed; /* ØªØ«Ø¨ÙŠØª Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø·ÙˆØ± Ù„ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        #developer-signature {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 9999;
            font-size: 0.8rem; /* ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            color: rgba(255, 255, 255, 0.6);
            pointer-events: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            /* Ø¥Ø¶Ø§ÙØ© Ø®Ù„ÙÙŠØ© Ù„Ù„Ø´Ø±ÙŠØ· Ø¹Ø´Ø§Ù† Ø§Ù„ÙƒÙ„Ø§Ù… Ù…ÙŠØ¯Ø®Ù„Ø´ ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ù…Ø§ ØªÙ†Ø²Ù„ */
            background: rgba(8, 8, 16, 0.9);
            backdrop-filter: blur(5px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .dev-name {
            color: var(--primary);
            font-weight: 700;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 70%;
        }

        #sound-toggle-btn {
            pointer-events: auto;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--primary);
            padding: 0;
            border-radius: 50%;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px; /* ØªØµØºÙŠØ± Ø§Ù„Ø²Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
            height: 35px;
            font-size: 1rem;
            z-index: 10000;
            flex-shrink: 0;
        }

        #sound-toggle-btn:hover {
            background: rgba(0, 255, 157, 0.1);
            border-color: var(--primary);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        .screen {
            position: relative; /* ØªØºÙŠÙŠØ± Ù…Ù† absolute Ù„Ù€ relative Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            min-height: 100vh;
            width: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            /* ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø°Ø§Ø© Ù„ØªØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ù†ØªØµÙ */
            justify-content: flex-start; 
            padding: 80px 20px 40px 20px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† ÙÙˆÙ‚ Ø¹Ø´Ø§Ù† Ø´Ø±ÙŠØ· Ø§Ù„Ø§Ø³Ù… */
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 1;
        }

        /* ØªÙˆØ³ÙŠØ· Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙÙ‚Ø· */
        #start-screen {
            justify-content: center;
            min-height: 100vh;
            padding-top: 60px;
        }

        .screen.active {
            display: flex;
            opacity: 1;
            z-index: 10;
        }

        .glitch-text {
            font-size: 2.8rem; /* ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
            font-weight: 900;
            color: var(--primary);
            text-shadow: 2px 2px var(--secondary);
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-align: center;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #fff;
            margin-bottom: 15px;
            opacity: 0.8;
            text-align: center;
        }

        .prayer-text {
            color: #ffd700;
            font-size: 1rem;
            margin-bottom: 25px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            animation: glow 3s infinite alternate;
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            text-align: center;
            line-height: 1.4;
        }

        @keyframes glow {
            from { text-shadow: 0 0 5px rgba(255, 215, 0, 0.2); border-color: rgba(255,215,0,0.2); }
            to { text-shadow: 0 0 15px rgba(255, 215, 0, 0.6); border-color: rgba(255,215,0,0.5); }
        }

        .mission-brief {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            border-right: 4px solid var(--secondary);
            width: 100%;
            max-width: 500px;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: right;
            backdrop-filter: blur(5px);
            font-size: 0.95rem;
        }

        .mode-select {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            max-width: 600px;
            padding-bottom: 20px; /* Ù…Ø³Ø§ÙØ© Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ */
        }

        .action-btn {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.2s;
            font-family: var(--font-main);
            text-transform: uppercase;
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.1);
            flex: 1 1 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            min-width: 140px; /* Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ù…Ù†Ø§Ø³Ø¨ */
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px var(--primary);
            background: rgba(0, 255, 157, 0.1);
        }

        .action-btn:active {
            transform: scale(0.98);
        }

        .survival-btn {
            border-color: var(--secondary);
            color: var(--secondary);
            box-shadow: 0 0 10px rgba(255, 0, 85, 0.1);
        }

        .survival-btn:hover {
            box-shadow: 0 0 15px var(--secondary);
            background: rgba(255, 0, 85, 0.1);
        }

        .training-btn {
            border-color: var(--training);
            color: var(--training);
            box-shadow: 0 0 10px rgba(0, 210, 255, 0.1);
        }

        .training-btn:hover {
            box-shadow: 0 0 15px var(--training);
            background: rgba(0, 210, 255, 0.1);
        }

        .game-header {
            width: 100%;
            max-width: 800px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            flex-wrap: wrap; /* Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ùˆ Ø§Ù„Ø´Ø§Ø´Ø© ØµØºÙŠØ±Ø© */
            gap: 10px;
        }

        .hud-item {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .timer-box {
            color: #ffd700;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            min-width: 50px;
            text-align: center;
            background: rgba(255,255,255,0.05);
            padding: 2px 8px;
            border-radius: 4px;
        }

        .status-icon {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary);
        }

        .game-content {
            width: 100%;
            max-width: 800px;
            flex-grow: 1; /* ÙŠØ³Ù…Ø­ Ù„Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø£Ø®Ø° Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© */
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding-bottom: 20px;
        }

        .story-log {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #aaddff;
            border-left: 3px solid var(--primary);
            min-height: 40px;
            display: flex;
            align-items: center;
            line-height: 1.4;
        }

        .log-time {
            color: var(--primary);
            font-weight: bold;
            margin-left: 8px;
            flex-shrink: 0;
        }

        .question-container {
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        #question-text {
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .code-view {
            background: #111;
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            direction: ltr;
            text-align: left;
            font-family: 'Consolas', monospace;
            color: #e6db74;
            overflow-x: auto; /* ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø£ÙÙ‚ÙŠ Ù„Ù„ÙƒÙˆØ¯ */
            display: none;
            font-size: 0.9rem;
            white-space: pre;
            -webkit-overflow-scrolling: touch; /* ØªÙ…Ø±ÙŠØ± Ø³Ù„Ø³ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        }

        .choices-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .choice-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            text-align: center;
            font-weight: bold;
            font-family: var(--font-main);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px; /* Ø¶Ù…Ø§Ù† Ø§Ø±ØªÙØ§Ø¹ ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø³ */
        }

        .choice-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary);
        }

        .choice-btn:active {
            transform: scale(0.98);
        }

        .choice-btn.correct {
            background: rgba(0, 255, 157, 0.2);
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.2);
        }

        .choice-btn.wrong {
            background: rgba(255, 0, 85, 0.2);
            border-color: var(--secondary);
            animation: shake 0.4s ease-in-out;
        }

        .game-footer {
            width: 100%;
            max-width: 800px;
            margin-top: auto;
            position: sticky; /* Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ«Ø¨ÙŠØª Ø§Ù„ÙÙˆØªØ± Ù„Ùˆ Ø£Ù…ÙƒÙ† */
            bottom: 10px;
        }

        .xp-bar-wrapper {
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        #xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #00c3ff);
            transition: width 0.5s ease;
        }

        .footer-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(10, 10, 15, 0.9);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .score-display {
            font-weight: bold;
            color: var(--primary);
            font-size: 0.95rem;
        }

        .nav-btn {
            background: none;
            border: 1px solid rgba(255,255,255,0.2);
            color: #aaa;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-family: var(--font-main);
            transition: 0.3s;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            border-color: #fff;
            color: #fff;
            background: rgba(255,255,255,0.05);
        }

        .result-card {
            background: var(--panel-bg);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid var(--primary);
            text-align: center;
            max-width: 90%;
            width: 400px;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            margin: auto; /* Ù„ØªÙˆØ³ÙŠØ·Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© */
        @media (max-width: 768px) {
            .choices-grid { 
                grid-template-columns: 1fr; /* Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª ØªØ­Øª Ø¨Ø¹Ø¶ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            }
            .glitch-text { 
                font-size: 2rem; 
            }
            .subtitle {
                font-size: 1rem;
            }
            .mission-brief {
                font-size: 0.85rem;
                padding: 15px;
            }
            #question-text { 
                font-size: 1rem; 
            }
            .choice-btn { 
                padding: 12px; 
                font-size: 0.9rem;
            }
            .mode-select { 
                flex-direction: column; 
            }
            .action-btn { 
                width: 100%; 
            }
            .dev-name {
                font-size: 0.8rem;
            }
            .game-header {
                justify-content: center;
            }
            .hud-item {
                font-size: 0.8rem;
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes scan {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--primary), var(--secondary));
            animation: scan 2s linear infinite;
        }

        .end-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
        }

        .secondary-btn {
            border-color: #fff;
            color: #fff;
        }
        
        .secondary-btn:hover {
            background: #fff;
            color: #000;
        }
    </style>
</head>
<body>

    <div id="developer-signature">
        <span>Dev: <span class="dev-name">Mohamed Diaa AbdALSalam</span></span>
        <button id="sound-toggle-btn" onclick="toggleSound()">ğŸ”Š</button>
    </div>

    <section id="start-screen" class="screen active">
        <div class="glitch-wrapper">
            <h1 class="glitch-text" data-text="CYBER CORE">MOHAMED CYBER DEFENSE</h1>
        </div>
        <div class="prayer-text">âœ¨ Ø§Ù„Ù„Ù‡Ù… ØµÙ„ ÙˆØ³Ù„Ù… ÙˆØ¨Ø§Ø±Ùƒ Ø¹Ù„Ù‰ Ù†Ø¨ÙŠÙ†Ø§ Ù…Ø­Ù…Ø¯ âœ¨</div>
        <h2 class="subtitle">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ</h2>
        <div class="mission-brief">
            <p>ØªØ­Ø°ÙŠØ±: ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…ğŸ˜¶â€ğŸŒ«ï¸.</p>
            <p>Ø§Ù„Ù…Ù‡Ù…Ø©: Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø«ØºØ±Ø§Øªâš ï¸.</p>
            <p>Ù‡Ø¯ÙÙŠ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©: ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„ Ù…Ø³Ù„ÙŠğŸ‘Œ.</p>
        </div>
        <div class="mode-select">
            <button onmouseenter="playSound('hover')" onclick="initGame('campaign')" class="action-btn">ğŸ›¡ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
            <button onmouseenter="playSound('hover')" onclick="initGame('survival')" class="action-btn survival-btn">ğŸ’€ ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ù‚Ø§Ø¡</button>
            <button onmouseenter="playSound('hover')" onclick="initGame('training')" class="action-btn training-btn">ğŸ“ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯Ø±ÙŠØ¨</button>
        </div>
    </section>

    <section id="game-screen" class="screen">
        <header class="game-header">
            <div class="hud-item">
                <span class="status-icon"></span> Ø§Ù„Ø¯Ø±Ø¹: <span id="shield-integrity">100%</span>
            </div>
            <div class="hud-item timer-box">
                <span id="timer-icon">â±ï¸</span> <span id="timer-display">20</span>s
            </div>
            <div class="hud-item">
                Ø§Ù„Ù‡Ø¯Ù: <span id="current-stage">1</span>
            </div>
        </header>

        <main class="game-content">
            <div class="story-log" id="story-log">
                <span class="log-time">>_ SYSTEM:</span> <span id="story-text">Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø¹Ø±ÙƒØ©...</span>
            </div>

            <div class="question-container">
                <h3 id="question-text">Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„</h3>
            </div>

            <div id="code-panel" class="code-view">
                <pre><code id="code-display"></code></pre>
            </div>

            <div id="choices-panel" class="choices-grid">
            </div>
        </main>

        <footer class="game-footer">
            <div class="xp-bar-wrapper">
                <div id="xp-fill" style="width: 0%"></div>
            </div>
            <div class="footer-controls">
                <div class="score-display">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score-number">0</span></div>
                <button id="home-btn-game" class="nav-btn" onmouseenter="playSound('hover')" onclick="goHome()">ğŸ  Ø®Ø±ÙˆØ¬</button>
            </div>
        </footer>
    </section>

    <section id="end-screen" class="screen" style="justify-content: center;">
        <div class="result-card">
            <h1 id="end-title">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù‡Ù…Ø©</h1>
            <p id="end-message">Ø§Ù„ÙˆØµÙ</p>
            <div class="final-stats">
                <div style="font-size: 1.5rem; margin: 15px 0; color: var(--primary);">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="final-score">0</span></div>
            </div>
            <div class="end-actions">
                <button id="restart-btn" onmouseenter="playSound('hover')" class="action-btn" onclick="restartGame()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
                <button id="home-btn-end" onmouseenter="playSound('hover')" class="action-btn secondary-btn" onclick="goHome()">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            </div>
        </div>
    </section>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isMuted = false;

        function toggleSound() {
            isMuted = !isMuted;
            const btn = document.getElementById('sound-toggle-btn');
            btn.innerHTML = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
            btn.style.borderColor = isMuted ? 'var(--secondary)' : 'rgba(255,255,255,0.2)';
            if (!isMuted && audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playSound(type) {
            if (isMuted) return;
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            const now = audioCtx.currentTime;

            if (type === 'hover') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(800, now);
                oscillator.frequency.exponentialRampToValueAtTime(1200, now + 0.05);
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.05);
                oscillator.start(now);
                oscillator.stop(now + 0.05);
            } 
            else if (type === 'click') {
                oscillator.type = 'square';
                oscillator.frequency.setValueAtTime(600, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            }
            else if (type === 'correct') {
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.setValueAtTime(554, now + 0.1); 
                oscillator.frequency.setValueAtTime(659, now + 0.2); 
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.4);
                oscillator.start(now);
                oscillator.stop(now + 0.4);
            }
            else if (type === 'wrong') {
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(150, now);
                oscillator.frequency.linearRampToValueAtTime(100, now + 0.3);
                gainNode.gain.setValueAtTime(0.2, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.3);
                oscillator.start(now);
                oscillator.stop(now + 0.3);
            }
            else if (type === 'start') {
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(200, now);
                oscillator.frequency.linearRampToValueAtTime(800, now + 0.5);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.5);
                oscillator.start(now);
                oscillator.stop(now + 0.5);
            }
        }

        const storyBeats = [
            "Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§Ù„Ù†Ø§Ø±ÙŠ... Ø§Ù„Ù‚ÙˆØ§Øª ØªØªØ£Ù‡Ø¨.",
            "ØªÙ… Ø±ØµØ¯ ÙÙŠØ±ÙˆØ³ ÙÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©.",
            "ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© ØªØ­Øª Ø§Ù„Ø¶ØºØ·ØŒ Ù†Ø­ØªØ§Ø¬ Ù„ÙƒÙˆØ¯ Ù†Ø¸ÙŠÙ.",
            "Ø§Ù„Ù‡Ø§ÙƒØ±Ø² ÙŠØ­Ø§ÙˆÙ„ÙˆÙ† Ø³Ø±Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø£ØºÙ„Ù‚ Ø§Ù„Ù…Ù†Ø§ÙØ°!",
            "ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© 40% Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±Ø§ØªØŒ ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù….",
            "Ù‡Ø¬ÙˆÙ… DDOS Ø¹Ù†ÙŠÙ! Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø­Ù…Ø§ÙŠØ©.",
            "Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ØªØ¹ÙˆØ¯ Ù„Ù„Ø¹Ù…Ù„ ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹...",
            "ØªÙ… Ø¹Ø²Ù„ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„Ø®Ø¨ÙŠØ«Ø© Ø¨Ù†Ø¬Ø§Ø­.",
            "Ø§Ù„Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©! Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù‡Ùˆ Ø§Ù„ÙØ§ØµÙ„."
        ];

        const questionsBank = [
            { q: "Ù…Ø§ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„ØªØ¹Ø±ÙŠÙ Ø«Ø§Ø¨ØªØŸ", a: [{t:"const",c:true}, {t:"let",c:false}, {t:"var",c:false}, {t:"static",c:false}] },
            { q: "Ø£ÙŠ Ù†ÙˆØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙŠØ³ Ø¨Ø¯Ø§Ø¦ÙŠØ§Ù‹ (Primitive)ØŸ", a: [{t:"Object",c:true}, {t:"String",c:false}, {t:"Number",c:false}, {t:"Boolean",c:false}] },
            { q: "Ù…Ø§ Ù†Ø§ØªØ¬ 5 + '5' ÙÙŠ Ø¬Ø§ÙØ§ Ø³ÙƒØ±ÙŠØ¨ØªØŸ", a: [{t:"'55'",c:true}, {t:"10",c:false}, {t:"Error",c:false}, {t:"NaN",c:false}] },
            { q: "ÙƒÙŠÙ Ù†ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹ ÙÙŠ JSØŸ", a: [{t:"// comment",c:true}, {t:"<--comment-->",c:false}, {t:"# comment",c:false}, {t:"/* comment",c:false}] },
            { q: "Ù…Ø§ ÙˆØ¸ÙŠÙØ© Array.push()ØŸ", a: [{t:"Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù†Ù‡Ø§ÙŠØ©",c:true}, {t:"Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",c:false}, {t:"Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©",c:false}, {t:"Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø¹Ù„Ù† Ø¹Ù† Ø¯Ø§Ù„Ø© Ø³Ù‡Ù…ÙŠØ©ØŸ", c: "const myFunc = ___", a: [{t:"() => {}",c:true}, {t:"function() {}",c:false}, {t:"=> () {}",c:false}, {t:"func => {}",c:false}] },
            { q: "Ù…Ø§Ø°Ø§ ÙŠØ±Ø¬Ø¹ typeof []ØŸ", a: [{t:"'object'",c:true}, {t:"'array'",c:false}, {t:"'list'",c:false}, {t:"'null'",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø±Ø¨Ø· Ù…Ù„Ù JS Ø®Ø§Ø±Ø¬ÙŠØŸ", a: [{t:"<script src='...'>",c:true}, {t:"<link href='...'>",c:false}, {t:"<js file='...'>",c:false}, {t:"<include src='...'>",c:false}] },
            { q: "Ø£ÙŠ Ù…Ù…Ø§ ÙŠÙ„ÙŠ ÙŠØ¹ØªØ¨Ø± LoopØŸ", a: [{t:"for",c:true}, {t:"if",c:false}, {t:"switch",c:false}, {t:"const",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ DOMØŸ", a: [{t:"Document Object Model",c:true}, {t:"Data Object Mode",c:false}, {t:"Digital Ordinance Model",c:false}, {t:"Disk Operating Method",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø®ØªØ§Ø± Ø¹Ù†ØµØ± Ø¨Ù€ IDØŸ", a: [{t:"getElementById",c:true}, {t:"querySelectorAll",c:false}, {t:"getElementsByClass",c:false}, {t:"getId",c:false}] },
            { q: "Ù…Ø§ ÙˆØ¸ÙŠÙØ© console.logØŸ", a: [{t:"Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„",c:true}, {t:"Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡",c:false}, {t:"Ø·Ø¨Ø§Ø¹Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø©",c:false}, {t:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",c:false}] },
            { q: "Ù…Ø§ Ù†Ø§ØªØ¬ 10 % 3ØŸ", a: [{t:"1",c:true}, {t:"3",c:false}, {t:"0",c:false}, {t:"10",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø­ÙˆÙ„ Ù†Øµ '100' Ù„Ø±Ù‚Ù…ØŸ", a: [{t:"parseInt('100')",c:true}, {t:"toString('100')",c:false}, {t:"parseNumber('100')",c:false}, {t:"toInt('100')",c:false}] },
            { q: "Ø§Ù„Ø±Ù…Ø² || ÙŠØ¹Ù†ÙŠØŸ", a: [{t:"OR (Ø£Ùˆ)",c:true}, {t:"AND (Ùˆ)",c:false}, {t:"NOT (Ù„Ø§)",c:false}, {t:"XOR",c:false}] },
            { q: "Ø§Ù„Ø±Ù…Ø² && ÙŠØ¹Ù†ÙŠØŸ", a: [{t:"AND (Ùˆ)",c:true}, {t:"OR (Ø£Ùˆ)",c:false}, {t:"EQUAL",c:false}, {t:"PLUS",c:false}] },
            { q: "Ù…Ø§ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† == Ùˆ ===ØŸ", a: [{t:"=== ØªÙ‚Ø§Ø±Ù† Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ù‚ÙŠÙ…Ø©",c:true}, {t:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ±Ù‚",c:false}, {t:"== Ø£Ø¯Ù‚",c:false}, {t:"== ØªÙ‚Ø§Ø±Ù† Ø§Ù„Ù†ÙˆØ¹ ÙÙ‚Ø·",c:false}] },
            { q: "ÙƒÙŠÙ Ù†ÙˆÙ‚Ù Ø­Ù„Ù‚Ø© ØªÙƒØ±Ø§Ø±ØŸ", a: [{t:"break",c:true}, {t:"stop",c:false}, {t:"exit",c:false}, {t:"return",c:false}] },
            { q: "Ù…Ø§Ø°Ø§ ÙŠÙØ¹Ù„ continueØŸ", a: [{t:"ÙŠØªØ®Ø·Ù‰ Ù„Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©",c:true}, {t:"ÙŠÙˆÙ‚Ù Ø§Ù„Ø­Ù„Ù‚Ø©",c:false}, {t:"ÙŠØ¹ÙŠØ¯ Ø§Ù„Ø¯Ø§Ù„Ø©",c:false}, {t:"ÙŠØ®Ø±Ø¬ Ù…Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ù†Ø´Ø¦ ÙƒØ§Ø¦Ù† (Object)ØŸ", a: [{t:"{ key: value }",c:true}, {t:"[ key: value ]",c:false}, {t:"( key: value )",c:false}, {t:"< key: value >",c:false}] },
            { q: "ÙƒÙŠÙ Ù†ØµÙ„ Ù„Ø®Ø§ØµÙŠØ© name ÙÙŠ objØŸ", a: [{t:"obj.name",c:true}, {t:"obj(name)",c:false}, {t:"obj->name",c:false}, {t:"obj:name",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ index Ø£ÙˆÙ„ Ø¹Ù†ØµØ± ÙÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ©ØŸ", a: [{t:"0",c:true}, {t:"1",c:false}, {t:"-1",c:false}, {t:"null",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø¹Ø±Ù Ø·ÙˆÙ„ Ø§Ù„Ù…ØµÙÙˆÙØ©ØŸ", a: [{t:"arr.length",c:true}, {t:"arr.size",c:false}, {t:"arr.count",c:false}, {t:"arr.long",c:false}] },
            { q: "Ù…Ø§ ÙˆØ¸ÙŠÙØ© Array.pop()ØŸ", a: [{t:"Ø­Ø°Ù Ø¢Ø®Ø± Ø¹Ù†ØµØ±",c:true}, {t:"Ø­Ø°Ù Ø£ÙˆÙ„ Ø¹Ù†ØµØ±",c:false}, {t:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ±",c:false}, {t:"Ù†Ø³Ø® Ø§Ù„Ù…ØµÙÙˆÙØ©",c:false}] },
            { q: "Ù…Ø§ Ù‡ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„Ø°ÙŠ Ù„Ù… ÙŠØ¹ÙŠÙ† Ù„Ù‡ Ù‚ÙŠÙ…Ø©ØŸ", a: [{t:"undefined",c:true}, {t:"null",c:false}, {t:"0",c:false}, {t:"error",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø¶ÙŠÙ ØµÙ†Ù (class) Ù„Ø¹Ù†ØµØ±ØŸ", a: [{t:"el.classList.add()",c:true}, {t:"el.addClass()",c:false}, {t:"el.class = ''",c:false}, {t:"el.className()",c:false}] },
            { q: "Ù…Ø§ Ø§Ù„Ø­Ø¯Ø« Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¹Ù†ØµØ±ØŸ", a: [{t:"click",c:true}, {t:"mouse",c:false}, {t:"hover",c:false}, {t:"press",c:false}] },
            { q: "Ø¯Ø§Ù„Ø© ØªÙ†ÙØ° ÙƒÙˆØ¯ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯ØŸ", a: [{t:"setTimeout",c:true}, {t:"setInterval",c:false}, {t:"setTime",c:false}, {t:"doLater",c:false}] },
            { q: "Ø¯Ø§Ù„Ø© ØªÙƒØ±Ø± ÙƒÙˆØ¯ ÙƒÙ„ ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ©ØŸ", a: [{t:"setInterval",c:true}, {t:"setTimeout",c:false}, {t:"loopTime",c:false}, {t:"repeat",c:false}] },
            { q: "ÙƒÙŠÙ Ù†ØºÙŠØ± Ù†Øµ Ø¹Ù†ØµØ± HTMLØŸ", a: [{t:"innerText",c:true}, {t:"changeText",c:false}, {t:"textValue",c:false}, {t:"write",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ JSONØŸ", a: [{t:"ØµÙŠØºØ© Ù„ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",c:true}, {t:"Ù„ØºØ© Ø¨Ø±Ù…Ø¬Ø©",c:false}, {t:"Ù…ÙƒØªØ¨Ø© Ø¬Ø§ÙØ§",c:false}, {t:"Ù…Ø­Ø±Ø± Ù†ØµÙˆØµ",c:false}] },
            { q: "ØªØ­ÙˆÙŠÙ„ ÙƒØ§Ø¦Ù† JSON Ù„Ù†ØµØŸ", a: [{t:"JSON.stringify()",c:true}, {t:"JSON.parse()",c:false}, {t:"JSON.toString()",c:false}, {t:"JSON.toText()",c:false}] },
            { q: "ØªØ­ÙˆÙŠÙ„ Ù†Øµ JSON Ù„ÙƒØ§Ø¦Ù†ØŸ", a: [{t:"JSON.parse()",c:true}, {t:"JSON.stringify()",c:false}, {t:"JSON.object()",c:false}, {t:"JSON.convert()",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ 'this' ÙÙŠ JSØŸ", a: [{t:"ÙŠØ´ÙŠØ± Ù„Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ",c:true}, {t:"ÙŠØ´ÙŠØ± Ù„Ù„Ù…Ù„Ù Ø§Ù„Ø³Ø§Ø¨Ù‚",c:false}, {t:"Ø§Ø³Ù… Ù…ØªØºÙŠØ±",c:false}, {t:"Ø¯Ø§Ù„Ø© Ø¹Ø§Ù…Ø©",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ù…Ù†Ø¹ Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù†Ù…ÙˆØ°Ø¬ØŸ", a: [{t:"e.preventDefault()",c:true}, {t:"e.stop()",c:false}, {t:"e.noDefault()",c:false}, {t:"e.cancel()",c:false}] },
            { q: "CSS: ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©ØŸ", a: [{t:"background-color",c:true}, {t:"color-background",c:false}, {t:"bg-color",c:false}, {t:"wall-color",c:false}] },
            { q: "CSS: ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø·ØŸ", a: [{t:"font-size",c:true}, {t:"text-size",c:false}, {t:"font-height",c:false}, {t:"size",c:false}] },
            { q: "CSS: Ø¬Ø¹Ù„ Ø§Ù„Ù†Øµ Ø¹Ø±ÙŠØ¶ØŸ", a: [{t:"font-weight: bold",c:true}, {t:"font-style: bold",c:false}, {t:"text: bold",c:false}, {t:"bold: true",c:false}] },
            { q: "CSS: ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©ØŸ", a: [{t:"margin",c:true}, {t:"padding",c:false}, {t:"border",c:false}, {t:"spacing",c:false}] },
            { q: "CSS: ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©ØŸ", a: [{t:"padding",c:true}, {t:"margin",c:false}, {t:"insect",c:false}, {t:"gap",c:false}] },
            { q: "HTML: ÙˆØ³Ù… Ø£ÙƒØ¨Ø± Ø¹Ù†ÙˆØ§Ù†ØŸ", a: [{t:"<h1>",c:true}, {t:"<head>",c:false}, {t:"<title>",c:false}, {t:"<h6>",c:false}] },
            { q: "HTML: ÙˆØ³Ù… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØºÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø©ØŸ", a: [{t:"<ul>",c:true}, {t:"<ol>",c:false}, {t:"<li>",c:false}, {t:"<dl>",c:false}] },
            { q: "HTML: ÙˆØ³Ù… Ø§Ù„ØµÙˆØ±Ø©ØŸ", a: [{t:"<img>",c:true}, {t:"<image>",c:false}, {t:"<pic>",c:false}, {t:"<src>",c:false}] },
            { q: "HTML: ÙˆØ³Ù… Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ", a: [{t:"<a>",c:true}, {t:"<link>",c:false}, {t:"<href>",c:false}, {t:"<url>",c:false}] },
            { q: "JS: Ù‡Ù„ JS Ø­Ø³Ø§Ø³Ø© Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø­Ø±ÙØŸ", a: [{t:"Ù†Ø¹Ù…",c:true}, {t:"Ù„Ø§",c:false}, {t:"Ø£Ø­ÙŠØ§Ù†Ø§Ù‹",c:false}, {t:"ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙÙ‚Ø·",c:false}] },
            { q: "JS: Ù…Ø§ Ù†Ø§ØªØ¬ true + 1ØŸ", a: [{t:"2",c:true}, {t:"1",c:false}, {t:"true1",c:false}, {t:"error",c:false}] },
            { q: "JS: Ù…Ø§ Ù†Ø§ØªØ¬ !trueØŸ", a: [{t:"false",c:true}, {t:"true",c:false}, {t:"undefined",c:false}, {t:"null",c:false}] },
            { q: "JS: Ø¬Ù…Ù„Ø© Ø§Ù„Ø´Ø±Ø· Ø§Ù„Ù…Ø®ØªØµØ±Ø©ØŸ", a: [{t:"Ternary Operator",c:true}, {t:"Short If",c:false}, {t:"Quick If",c:false}, {t:"ElseIf",c:false}] },
            { q: "Ù…Ø§ Ù‡ÙŠ NaNØŸ", a: [{t:"Not a Number",c:true}, {t:"New a Number",c:false}, {t:"Null and None",c:false}, {t:"No a Name",c:false}] },
            { q: "Ø¯Ø§Ù„Ø© Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£ÙƒØ¨Ø± Ø±Ù‚Ù…ØŸ", a: [{t:"Math.max()",c:true}, {t:"Math.top()",c:false}, {t:"Math.biggest()",c:false}, {t:"Math.high()",c:false}] },
            { q: "Ø¯Ø§Ù„Ø© Ù„ØªÙˆÙ„ÙŠØ¯ Ø±Ù‚Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠØŸ", a: [{t:"Math.random()",c:true}, {t:"Math.rand()",c:false}, {t:"Math.gen()",c:false}, {t:"random()",c:false}] },
            { q: "ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø±Ù‚Ù… Ù„Ø£Ù‚Ø±Ø¨ Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ØŸ", a: [{t:"Math.round()",c:true}, {t:"Math.floor()",c:false}, {t:"Math.ceil()",c:false}, {t:"Math.int()",c:false}] },
            { q: "Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ù„Ù„Ø£Ø¯Ù†Ù‰ Ø¯Ø§Ø¦Ù…Ø§Ù‹ØŸ", a: [{t:"Math.floor()",c:true}, {t:"Math.ceil()",c:false}, {t:"Math.down()",c:false}, {t:"Math.low()",c:false}] },
            { q: "Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ù„Ù„Ø£Ø¹Ù„Ù‰ Ø¯Ø§Ø¦Ù…Ø§Ù‹ØŸ", a: [{t:"Math.ceil()",c:true}, {t:"Math.top()",c:false}, {t:"Math.up()",c:false}, {t:"Math.high()",c:false}] },
            { q: "Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ù‚ÙŠÙ…Ø© Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ØŸ", a: [{t:"change",c:true}, {t:"click",c:false}, {t:"hover",c:false}, {t:"modify",c:false}] },
            { q: "Ø®Ø§ØµÙŠØ© CSS Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ø·ØŸ", a: [{t:"font-family",c:true}, {t:"font-type",c:false}, {t:"text-style",c:false}, {t:"font-name",c:false}] },
            { q: "ÙƒÙŠÙ Ù†Ø¬Ø¹Ù„ Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„ÙˆØ³Ø· CSSØŸ", a: [{t:"text-align: center",c:true}, {t:"font-align: center",c:false}, {t:"align: center",c:false}, {t:"center: text",c:false}] },
            { q: "Ø¥Ø®ÙØ§Ø¡ Ø¹Ù†ØµØ± ØªÙ…Ø§Ù…Ø§Ù‹ CSSØŸ", a: [{t:"display: none",c:true}, {t:"visibility: hidden",c:false}, {t:"opacity: 0",c:false}, {t:"hide: true",c:false}] },
            { q: "Ø¬Ø¹Ù„ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø±Ù†Ø§Ù‹ CSSØŸ", a: [{t:"display: flex",c:true}, {t:"display: block",c:false}, {t:"display: grid",c:false}, {t:"float: left",c:false}] },
            { q: "ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙˆØ¯ Ù„Ø¹Ø¯Ø¯ Ù…Ø­Ø¯Ø¯ Ù…Ù† Ø§Ù„Ù…Ø±Ø§ØªØŸ", a: [{t:"For Loop",c:true}, {t:"While Loop",c:false}, {t:"Do While",c:false}, {t:"If Statement",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù€ ScopeØŸ", a: [{t:"Ù†Ø·Ø§Ù‚ Ø±Ø¤ÙŠØ© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª",c:true}, {t:"Ø§Ø³Ù… Ø¯Ø§Ù„Ø©",c:false}, {t:"Ù†ÙˆØ¹ Ø¨ÙŠØ§Ù†Ø§Øª",c:false}, {t:"Ù…ÙƒØªØ¨Ø© Ø®Ø§Ø±Ø¬ÙŠØ©",c:false}] },
            { q: "Ù…ØªØºÙŠØ±Ø§Øª let Ù„Ù‡Ø§ Ù†Ø·Ø§Ù‚ØŸ", a: [{t:"Block Scope",c:true}, {t:"Function Scope",c:false}, {t:"Global Only",c:false}, {t:"No Scope",c:false}] },
            { q: "Ù…ØªØºÙŠØ±Ø§Øª var Ù„Ù‡Ø§ Ù†Ø·Ø§Ù‚ØŸ", a: [{t:"Function Scope",c:true}, {t:"Block Scope",c:false}, {t:"Class Scope",c:false}, {t:"Tag Scope",c:false}] },
            { q: "Ø¯Ù…Ø¬ Ù…ØµÙÙˆÙØªÙŠÙ†ØŸ", a: [{t:"concat()",c:true}, {t:"join()",c:false}, {t:"merge()",c:false}, {t:"mix()",c:false}] },
            { q: "ØªØ­ÙˆÙŠÙ„ Ù…ØµÙÙˆÙØ© Ù„Ù†ØµØŸ", a: [{t:"join()",c:true}, {t:"concat()",c:false}, {t:"split()",c:false}, {t:"reverse()",c:false}] },
            { q: "Ù‚Ù„Ø¨ ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØµÙÙˆÙØ©ØŸ", a: [{t:"reverse()",c:true}, {t:"sort()",c:false}, {t:"flip()",c:false}, {t:"back()",c:false}] },
            { q: "ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹ØŸ", a: [{t:"sort()",c:true}, {t:"order()",c:false}, {t:"arrange()",c:false}, {t:"list()",c:false}] },
            { q: "Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ØµØ± ÙÙŠ Ù…ØµÙÙˆÙØ©ØŸ", a: [{t:"includes()",c:true}, {t:"has()",c:false}, {t:"contain()",c:false}, {t:"exist()",c:false}] },
            { q: "Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ù€ Index Ù„Ø¹Ù†ØµØ±ØŸ", a: [{t:"indexOf()",c:true}, {t:"search()",c:false}, {t:"find()",c:false}, {t:"location()",c:false}] },
            { q: "Ø¥Ù†Ø´Ø§Ø¡ Ù…ØµÙÙˆÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹Ø¯Ù„Ø©ØŸ", a: [{t:"map()",c:true}, {t:"forEach()",c:false}, {t:"loop()",c:false}, {t:"new()",c:false}] },
            { q: "ØªØµÙÙŠØ© Ø§Ù„Ù…ØµÙÙˆÙØ© Ø¨Ø´Ø±Ø·ØŸ", a: [{t:"filter()",c:true}, {t:"select()",c:false}, {t:"map()",c:false}, {t:"cut()",c:false}] },
            { q: "Ù‡Ù„ null === undefinedØŸ", a: [{t:"False",c:true}, {t:"True",c:false}, {t:"Error",c:false}, {t:"Sometimes",c:false}] },
            { q: "Ù‡Ù„ null == undefinedØŸ", a: [{t:"True",c:true}, {t:"False",c:false}, {t:"Error",c:false}, {t:"Never",c:false}] },
            { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù€ CallbackØŸ", a: [{t:"Ø¯Ø§Ù„Ø© ØªÙ…Ø±Ø± ÙƒÙ…Ø¹Ø§Ù…Ù„ Ù„Ø¯Ø§Ù„Ø© Ø£Ø®Ø±Ù‰",c:true}, {t:"Ø¯Ø§Ù„Ø© ØªØ³ØªØ¯Ø¹ÙŠ Ù†ÙØ³Ù‡Ø§",c:false}, {t:"Ø®Ø·Ø£ Ø¨Ø±Ù…Ø¬ÙŠ",c:false}, {t:"Ù†ÙˆØ¹ Ù…ØªØºÙŠØ±",c:false}] },
            { q: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù€ PromiseØŸ", a: [{t:"ÙƒØ§Ø¦Ù† Ù„Ø¹Ù…Ù„ÙŠØ§Øª ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø©",c:true}, {t:"Ø¯Ø§Ù„Ø© Ø´Ø±Ø·ÙŠØ©",c:false}, {t:"Ù…ØµÙÙˆÙØ©",c:false}, {t:"Ø­Ø¯Ø«",c:false}] }
        ];

        let state = {
            mode: null,
            score: 0,
            stage: 1,
            shield: 100,
            timeLeft: 0,
            timer: null,
            currentQ: null,
            streak: 0,
            usedQuestions: []
        };

        const screens = {
            start: document.getElementById('start-screen'),
            game: document.getElementById('game-screen'),
            end: document.getElementById('end-screen')
        };

        function switchScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            screens[id].classList.add('active');
            window.scrollTo(0, 0); // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø§Ø´Ø©
        }

        function initGame(mode) {
            playSound('start');
            state = {
                mode: mode,
                score: 0,
                stage: 1,
                shield: 100,
                timeLeft: mode === 'training' ? 999 : 20,
                timer: null,
                currentQ: null,
                streak: 0,
                usedQuestions: []
            };

            updateHUD();
            switchScreen('game');
            nextQuestion();
            if(mode !== 'training') startTimer();
        }

        function startTimer() {
            if(state.timer) clearInterval(state.timer);
            state.timer = setInterval(() => {
                state.timeLeft--;
                updateHUD();
                
                if(state.timeLeft <= 5) {
                    document.getElementById('timer-display').style.color = '#ff0055';
                }

                if(state.timeLeft <= 0) {
                    gameOver("Ù†ÙØ° Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ù‡Ø§ÙƒØ±Ø² Ø³ÙŠØ·Ø±ÙˆØ§ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù….");
                }
            }, 1000);
        }

        function updateHUD() {
            document.getElementById('score-number').innerText = state.score;
            document.getElementById('shield-integrity').innerText = state.shield + '%';
            document.getElementById('timer-display').innerText = state.timeLeft;
            document.getElementById('current-stage').innerText = state.stage;
            document.getElementById('xp-fill').style.width = (state.stage * 10) + '%';
            document.getElementById('timer-display').style.color = '#ffd700';
            
            // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ø¯Ø±Ø¹
            const shieldEl = document.getElementById('shield-integrity');
            if(state.shield > 70) shieldEl.style.color = 'var(--primary)';
            else if(state.shield > 30) shieldEl.style.color = 'orange';
            else shieldEl.style.color = 'var(--secondary)';
        }

        function nextQuestion() {
            // Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¤Ø§Ù„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ØºÙŠØ± Ù…ÙƒØ±Ø±
            let available = questionsBank.filter((_, i) => !state.usedQuestions.includes(i));
            if(available.length === 0) {
                if(state.mode === 'training') {
                    state.usedQuestions = []; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
                    available = questionsBank;
                } else {
                    gameOver("Ø£ØªÙ…Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ù†Ø¸Ø§Ù… Ø¢Ù…Ù† Ø§Ù„Ø¢Ù†.");
                    return;
                }
            }
            
            const qIndex = Math.floor(Math.random() * available.length);
            const originalIndex = questionsBank.indexOf(available[qIndex]);
            state.usedQuestions.push(originalIndex);
            
            state.currentQ = available[qIndex];
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            const storyText = document.getElementById('story-text');
            if(state.mode === 'campaign' && storyBeats[state.stage-1]) {
                storyText.innerText = storyBeats[state.stage-1];
            } else if (state.mode === 'survival') {
                storyText.innerText = `Ù…ÙˆØ¬Ø© Ø§Ù„Ù‡Ø¬ÙˆÙ…: ${state.stage}`;
            } else {
                storyText.innerText = "ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯Ø±ÙŠØ¨: Ø­Ø³Ù‘Ù† Ù…Ù‡Ø§Ø±Ø§ØªÙƒ.";
            }

            document.getElementById('question-text').innerText = state.currentQ.q;
            
            const codePanel = document.getElementById('code-panel');
            if(state.currentQ.c) {
                codePanel.style.display = 'block';
                document.getElementById('code-display').innerText = state.currentQ.c;
            } else {
                codePanel.style.display = 'none';
            }

            const choicesDiv = document.getElementById('choices-panel');
            choicesDiv.innerHTML = '';
            
            // Ø®Ù„Ø· Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
            let answers = [...state.currentQ.a].sort(() => Math.random() - 0.5);
            
            answers.forEach(ans => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerText = ans.t;
                btn.onclick = () => checkAnswer(ans.c, btn);
                choicesDiv.appendChild(btn);
            });

            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆÙ‚Øª ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ù‚Ø§Ø¡
            if(state.mode === 'survival') {
                state.timeLeft = Math.max(5, 20 - Math.floor(state.stage/2));
            } else if (state.mode === 'campaign') {
                state.timeLeft = 25;
            }
        }

        function checkAnswer(isCorrect, btn) {
            // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù…Ù†Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
            const btns = document.querySelectorAll('.choice-btn');
            btns.forEach(b => b.disabled = true);

            if(isCorrect) {
                playSound('correct');
                btn.classList.add('correct');
                state.score += (state.streak * 5) + 10;
                state.streak++;
                state.stage++;
                
                if(state.mode === 'survival') {
                    state.shield = Math.min(100, state.shield + 5);
                }

                setTimeout(() => {
                    nextQuestion();
                    updateHUD();
                }, 800);
            } else {
                playSound('wrong');
                btn.classList.add('wrong');
                state.streak = 0;
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                btns.forEach(b => {
                    const txt = b.innerText;
                    const correctAns = state.currentQ.a.find(x => x.c).t;
                    if(txt === correctAns) b.classList.add('correct');
                });

                if(state.mode === 'training') {
                    // ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ø§ Ù†Ø®Ø³Ø±ØŒ ÙÙ‚Ø· Ù†Ù†Ù‚Øµ Ø´ÙˆÙŠØ©
                    setTimeout(() => {
                        nextQuestion();
                        updateHUD();
                    }, 1500);
                } else {
                    state.shield -= 25;
                    updateHUD();
                    
                    if(state.shield <= 0) {
                        setTimeout(() => gameOver("ØªØ­Ø·Ù… Ø¬Ø¯Ø§Ø± Ø§Ù„Ø­Ù…Ø§ÙŠØ©! Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø®ØªØ±Ù‚."), 1000);
                    } else {
                        setTimeout(() => {
                            nextQuestion();
                        }, 1000);
                    }
                }
            }
        }

        function gameOver(msg) {
            clearInterval(state.timer);
            document.getElementById('end-title').innerText = state.shield <= 0 || state.timeLeft <= 0 ? "ÙØ´Ù„Øª Ø§Ù„Ù…Ù‡Ù…Ø©" : "Ù†Ø¬Ø­Øª Ø§Ù„Ù…Ù‡Ù…Ø©";
            document.getElementById('end-message').innerText = msg;
            document.getElementById('final-score').innerText = state.score;
            document.getElementById('end-title').style.color = state.shield <= 0 || state.timeLeft <= 0 ? 'var(--secondary)' : 'var(--primary)';
            switchScreen('end');
        }

        function goHome() {
            clearInterval(state.timer);
            playSound('click');
            switchScreen('start');
        }

        function restartGame() {
            playSound('click');
            initGame(state.mode);
        }
    </script>
</body>
</html>